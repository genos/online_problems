/ ngn/k FTW
i:+.'0:"input.txt"
+/{x|-x}'-/{x@<x}'i /part1
+/{(!x)*.x}0^(i.0)##'=i.1 /part2
